<!DOCTYPE html>
<html>
<head>
<title>Staples Schedule</title>
<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src ="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <style type="text/css">
    @import url(https://fonts.googleapis.com/css?family=Lato:400,100,300);
h1 {
    font-family: "Lato";
    font-size: 50px;
}
p {
 -webkit-transition: all 0.5s ease;
    font-size: 16px;
    font-size: 1rem;
    line-height: 23px;
    line-height: 1.4375rem;
    font-weight: 400;
    font-style: normal;
    font-family:"lato";
    font-size: 20px
}
h2 {
 -webkit-transition: all 0.5s ease;
    font-size: 40px;;
    font-family:"lato";
}
h3 {
  -webkit-transition: all 0.5s ease;
    font-size: 30px;
      font-family:"lato";
}
a,button {
    font-size: 16px;
    font-family:"Lato";
    text-decoration: none;

}
.button:hover {
    font-family:"Lato";
    background: #000;
    text-decoration: none;
    color: #fff;
    padding: 8px 40px;margin: 40px 0 70px;
}
span{
  font-size: 20px;
}
.hidden {
  display: none;
}
#P1,#P2,#P3,#P4,#P5,#P6{
  font-size: 40px;
}
.loading{
  display: none;
}
hr{
  color: blue;
  background-color: blue;
  height: 5px;
}
#myProgress {
    width: 100%;
    background-color: grey;
}
</style>
</head>
<body>
<link rel='shortcut icon' type='image/x-icon' href='shsicon.ico' />
<nav class="navbar navbar-light bg-light">
  <a class="navbar-brand" href="#"><img src="title.png" width="30" height="30" class="d-inline-block align-top" alt="">
  SHS X
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <p class="navbar-toggler-icon"></p>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav">
      <a class="nav-item nav-link active" href="http://shs.westportps.org/uploaded/site_files/shs/main_office/Lunch_Schedule_17-18.pdf" target="#myModal">Lunch Rotation <span class="sr-only">(current)</span></a>
      <!--<a class="nav-item nav-link disabled" href="#">Assignments</a>-->
      <a class="nav-item nav-link active" href="https://play.google.com/store/apps/details?id=com.hokucode.shsx">Check for Updates</a>
    </div>
  </div>
</nav>
<div class="progress">
  <div id="dayBar" class="progress-bar bg-success" role="progressbar" style="width: 100%;" aria-valuemin="0" aria-valuemax="100"></div>
</div>
</center>

<br/>
<center>
<span><P id ="P1" style="display:inline-block;"></P> 7:30 - 8:20</span>
<br/>
<span><P id ="P2" style="display:inline-block;"></P> 8:25 - 9:45</span>
<br/>
<span><P id ="P3" style="display:inline-block;"></P> 9:50- 10:40</span>
<br/>
<span><P id ="P4" style="display:inline-block;"></P> 10:45-12:25</span>
<br/>
<span><P id ="P5" style="display:inline-block;"></P> 12:30-1:20</span>
<br/>
<span><P id ="P6" style="display:inline-block;"></P> 1:25 - 2:15</span>
</center>
<div class="progress">
  <div id="myBar" class="progress-bar" role="progressbar" style="width: 100%;" aria-valuemin="0" aria-valuemax="100">100%</div>
</div>
<P id ="TI"></P><center><img class="loading" src="new.gif" id="foo" style="width:56px;height:56px;"></center><P id ="TL"></P>
<hr>
<h3 id="change">Future Dates:</h3>
<div class="form-row">
<input class="form-control" type="text" placeholder="" id="datepicker" style="width: 200px">
<br>
<button onclick="lday();"type="button" class="btn btn-dark">Load</button>
</div>
<hr class="hr-primary" />
<span style="padding-left:60000;border-color: white;"></span>
<span style="border-color: white;">
<!-- Button trigger modal -->
<button type="button btn-dark" class="btn btn-dark" data-toggle="modal" data-target="#myModal">
  Lunch Rotation
</button>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Lunch Rotation: 2018</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Academic Support Center:2
        <hr>
        Art:3
        <hr>
        English:2
        <hr>
        Fam and Consum. Sciences:3
        <hr>
        Math:2
        <hr>
        Media:3
        <hr>
        Music:3
        <hr>
        PE:3
        <hr>
        Gym:3
        <hr>
        Science:1
        <hr>
        Social Studies:1
        <hr>
        Special Ed.:2
        <hr>
        Technology:3
        <hr>
        Theater:2
        <hr>
        World Langauges:2
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<hr>
<button type="button btn-dark" class="btn btn-dark" data-toggle="modal" data-target="#Credits">
  Credits
</button>
<div class="modal fade" id="Credits" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Credits</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Rishabh Mandayam: App owner, back-end development
        <hr>
        Jacob Trock: Website Owner, front-end development
        <hr>
        Tommy Wimmier: Asthetic advisor, Created the logo, front-end development
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
<script>
  $( function() {
    $( "#datepicker" ).datepicker();
  } );
  </script>
<script type="text/javascript">
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
$('#myModal').on('shown.bs.modal', function () {
  $('#myInput').focus()
})

var es1; 
var es2;
var es3;
var es4;
var es5; 
var es6;
var ss1;
var ss2;
var ss3;
var ss4;
var ss5;
var ss6;
var dayloaded ='https://shsschedule.herokuapp.com/schedule/today';
function toggleImage() {
  var image = document.getElementById('image');
  image.classList.toggle('hidden');
}
  var data = document.getElementById('data');
  getDataFromServer();
  servetimes();
  var intervalID = window.setInterval(svptimes, 1000);
  function getDataFromServer() {
      var oReq = new XMLHttpRequest();
      oReq.addEventListener('load', svpnames);
      oReq.open("GET",dayloaded);
      oReq.send();
    }
    function svpnames() {
      var schedule=JSON.parse(this.responseText);
      var p1 = schedule[0].name;
      var p2 = schedule[1].name;
      var p3 = schedule[2].name;
      var p4 = schedule[3].name;
      var p5 = schedule[4].name;
      var p6 = schedule[5].name;
      for (let p of schedule) {
    document.getElementById("P1").innerHTML = p1;
    document.getElementById("P2").innerHTML = p2;
    document.getElementById("P3").innerHTML = p3;
    document.getElementById("P4").innerHTML = p4;
    document.getElementById("P5").innerHTML = p5;
    document.getElementById("P6").innerHTML = p6;
      }
    }
    function lday(){
      var datel=document.getElementById("datepicker").value;
      var month=datel.slice(0,2);
      console.log(month);
      var day=datel.slice(3,5);
      console.log(day);
      var year=datel.slice(6,10);
      console.log(year);
      dayloaded='https://shsschedule.herokuapp.com/schedule/'+year+month+day;
        document.getElementById("change").innerHTML = datel;
        getDataFromServer();
    }
    function servetimes() {
      var oReq = new XMLHttpRequest();
      oReq.addEventListener('load', loadTimes);
      oReq.open("GET","https://shsschedule.herokuapp.com/schedule/today");
      oReq.send();
    }
    function loadTimes(){
      var schedule=JSON.parse(this.responseText);
      es1 = schedule[0].end_seconds;
      es2 = schedule[1].end_seconds;
      es3 = schedule[2].end_seconds;
      es4 = schedule[3].end_seconds;
      es5 = schedule[4].end_seconds;
      es6 = schedule[5].end_seconds;
      ss1 = schedule[0].start_seconds;
      ss2 = schedule[1].start_seconds;
      ss3 = schedule[2].start_seconds;
      ss4 = schedule[3].start_seconds;
      ss5 = schedule[4].start_seconds;
      ss6 = schedule[5].start_seconds;
      svptimes(schedule)
    }
    function svptimes(schedule) {
      var tl;
      var tlseconds;
      var ti;
      var tiseconds;
      var d1 = new Date();
      var ctx = (((d1.getUTCHours()-4)*60)*60)+(d1.getUTCMinutes()*60)+(d1.getUTCSeconds());
      var timetex = (((d1.getUTCHours()-4)*60)*60)+(d1.getUTCMinutes()*60);

      document.getElementById("dayBar").style.width = (ctx-ss1)/(es6-ss1)*100+'%';
      document.getElementById("dayBar").innerHTML=Math.trunc(((ctx-ss1)/(es6-ss1)*100))+'%';
      //for (let p of schedule) {
        if(timetex>ss1&&timetex<es1){
        tl = Math.trunc((es1-ctx)/60);
        tlseconds=Math.trunc((((es1-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss1)/60));
        tiseconds=Math.trunc((((ctx-ss1)/60)-ti)*60)
        document.getElementById("P1").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss1)/(es1-ss1)*100+'%';
        document.getElementById("myBar").innerHTML=Math.trunc(((ctx-ss1)/(es1-ss1)*100))+'%';
        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
        if(timetex>es1&&timetex<ss2){
        document.getElementById("P1").style.color = "black";
        tl = Math.trunc((ss2-ctx)/60);
        tlseconds=Math.trunc((((ss2-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-es1)/60));
        tiseconds=Math.trunc((((ctx-es1)/60)-ti)*60)
        document.getElementById("P2").style.color = "green";
        }
        if(timetex>ss2&&timetex<es2){
        document.getElementById("P1").style.color = "black";
        tl = Math.trunc((es2-ctx)/60);
        tlseconds=Math.trunc((((es2-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss2)/60));
        tiseconds=Math.trunc((((ctx-ss2)/60)-ti)*60)
        document.getElementById("P2").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss2)/(es2-ss2)*100+'%'
        document.getElementById("myBar").innerHTML=Math.trunc((ctx-ss2)/(es2-ss2)*100)+'%'

        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
        if(timetex>es2&&timetex<ss3){
        document.getElementById("P2").style.borderColor = "black";
        tl = Math.trunc((ss3-ctx)/60);
        tlseconds=Math.trunc((((ss3-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-es2)/60));
        tiseconds=Math.trunc((((ctx-es2)/60)-ti)*60)
        document.getElementById("P3").style.color = "green";
        }
        if(timetex>ss3&&timetex<es3){
        document.getElementById("P2").style.color = "black";
        tl = Math.trunc((es3-ctx)/60);
        tlseconds=Math.trunc((((es3-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss3)/60));
        tiseconds=Math.trunc((((ctx-ss3)/60)-ti)*60)
        document.getElementById("P3").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss3)/(es3-ss3)*100+'%';
        document.getElementById("myBar").innerHTML=Math.trunc(((ctx-ss3)/(es3-ss3)*100))+'%';
        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
        if(timetex>es3&timetex<ss4){
        document.getElementById("P3").style.color = "black";
        tl = Math.trunc((ss4-ctx)/60);
        tlseconds=Math.trunc((((ss4-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-es3)/60));
        tiseconds=Math.trunc((((ctx-es3)/60)-ti)*60)
        document.getElementById("P4").style.color = "green";
        }
        if(timetex>ss4&&timetex<es4){
        document.getElementById("P3").style.color = "black";
        tl = Math.trunc((es4-ctx)/60);
        tlseconds=Math.trunc((((es4-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss4)/60));
        tiseconds=Math.trunc((((ctx-ss4)/60)-ti)*60)
        document.getElementById("P4").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss4)/(es4-ss4)*100+'%';
        document.getElementById("myBar").innerHTML=Math.trunc(((ctx-ss4)/(es4-ss4)*100))+'%';
        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
        if(timetex>es4&timetex<ss5){
        document.getElementById("P4").style.color = "black";
        tl = Math.trunc((ss5-ctx)/60);
        tlseconds=Math.trunc((((ss5-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-es4)/60));
        tiseconds=Math.trunc((((ctx-es4)/60)-ti)*60)
        document.getElementById("P5").style.color = "green";
        }
        if(timetex>ss5&&timetex<es5){
        document.getElementById("P4").style.color = "black";
        tl = Math.trunc((es5-ctx)/60);
        tlseconds=Math.trunc((((es5-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss5)/60));
        tiseconds=Math.trunc((((ctx-ss5)/60)-ti)*60)
        document.getElementById("P5").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss5)/(es5-ss5)*100+'%';
        document.getElementById("myBar").innerHTML=Math.trunc(((ctx-ss5)/(es5-ss5)*100))+'%';
        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
        if(timetex>es5&timetex<ss6){
        document.getElementById("P5").style.color = "black";
        tl = Math.trunc((ss6-ctx)/60);
        tlseconds=Math.trunc((((ss6-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-es5)/60));
        tiseconds=Math.trunc((((ctx-es5)/60)-ti)*60)
        document.getElementById("P6").style.color = "green";
        }
        if(timetex>ss6&&timetex<es6){
        document.getElementById("P5").style.color = "black";
        tl = Math.trunc((es6-ctx)/60);
        tlseconds=Math.trunc((((es6-ctx)/60)-tl)*60)
        ti = Math.trunc(((ctx-ss6)/60));
        tiseconds=Math.trunc((((ctx-ss6)/60)-ti)*60)
        document.getElementById("P6").style.color = "blue";
        document.getElementById("myBar").style.width = (ctx-ss6)/(es6-ss6)*100+'%';
        document.getElementById("myBar").innerHTML=Math.trunc(((ctx-ss6)/(es6-ss6)*100))+'%';
        if (tl==4&&tlseconds==59){alert("there are less than 5 minutes left")}
        }
      //}
      if (timetex>es6){
        tl="-"
        tlseconds="-"
        ti="-"
        tiseconds="-"
        document.getElementById("TL").innerHTML = tl+tlseconds
        document.getElementById("TI").innerHTML = ti+tiseconds
        document.getElementById("foo").style.display = "none"
      }
      if (timetex<ss1){
        tl="-"
        tlseconds=" - "
        ti="-"
        tiseconds="-"
        document.getElementById("TL").innerHTML = tl+tlseconds
        document.getElementById("TI").innerHTML = ti+tiseconds
        document.getElementById("foo").style.display = "none"
      }
      if (ti==undefined){
        tl="Loading"
        tlseconds=" "
        ti="Loading"
        tiseconds=" "
        document.getElementById("TL").innerHTML = tl+tlseconds
        document.getElementById("TI").innerHTML = ti+tiseconds
        document.getElementById("foo").style.display = "inline-block"
      }
      else{
          if (tlseconds<10){
          document.getElementById("TL").innerHTML = "Time left: "+tl+":0"+tlseconds;
          document.getElementById("foo").style.display = "none"
      }   else{
          document.getElementById("TL").innerHTML = "Time left: "+tl+":"+tlseconds;
          document.getElementById("foo").style.display = "none"
      }
        if(tiseconds<10){
          document.getElementById("TI").innerHTML = "Time in: "+ti+":0"+tiseconds;
          document.getElementById("foo").style.display = "none"
      } else{
          document.getElementById("TI").innerHTML = "Time in: "+ti+":"+tiseconds;
          document.getElementById("foo").style.display = "none"
      }     
      }
      
    }
</script>
</body>
</html>


